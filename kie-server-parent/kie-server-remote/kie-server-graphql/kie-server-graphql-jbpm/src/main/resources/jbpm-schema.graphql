scalar Date
scalar Object

schema {
  """
  Root of Queries
  """
  query: Query

  """
  Root of Mutations
  """
  mutation: Mutation
}

type Query {
  """
  Root for process definition related queries
  """
  definitions: DefinitionQuery
  """
  Root for process instance related queries
  """
  instances: InstanceQuery
}

type Mutation {
  """
  Root for process instance related mutations
  """
  instances: InstanceMutation
}

"""
Collection of every query supported for ProcessDefinitions
"""
type DefinitionQuery {
  """
  Gets a single ProcessDefinition with provided processDefinitionId and containerId.
  """
  processDefinition(processDefinitionId: String!, containerId: String!): ProcessDefinition!

  """
  Gets list of UserTaskDefinition's for process definition with provided processDefinitionId and containerId.
  """
  userTaskDefinitions(processDefinitionId: String!, containerId: String!): [UserTaskDefinition!]!

  """
  Gets all available process definitions from runtime from all containers.
  """
  allProcessDefinitions(batchSize: Int = 100): [ProcessDefinition!]!

  """
  Gets list of ProcessDefinition objects with concrete processDefinitionId OR containerId, not both.
  """
  processDefinitions(processDefinitionId: String, containerId: String): [ProcessDefinition]
}

type InstanceQuery {
  """
  Gets a ProcessInstance with id and containerId.
  """
  processInstance(id: Long!, containerId: String!): ProcessInstance!

  """
  Gets all available process instances from runtime based on the filter combination.
  """
  allProcessInstances(batchSize: Int = 100, filter: ProcessInstanceFilter!): [ProcessInstance!]!

  """
  Gets list of ProcessVariable for process instance with id and containerId.
  """
  variables(id: Long!, containerId: String!): Object

  """
  Gets all available tasks from runtime based on the filter combination.
  """
  allTasks(batchSize: Int = 100, filter: TaskInstanceFilter!): [TaskSummary!]!

  """
  Gets task instance with specific ID.
  """
  taskInstance(taskId: Long!): TaskInstance

  """
  Gets task instance with specific workItemId.
  """
  taskInstance(workItemId: Long!): TaskInstance
}

type InstanceMutation {
  """
  Creates/Starts process instances defined by the input. Can be also used to start one process instance, just set batchSize to 1.
  """
  startProcesses(input: StartProcessesInput!) :[ProcessInstance!]!

  """
  Aborts process instances with specified id or if specified, also with containerId.
  """
  abortProcessInstances(input: AbortProcessInstancesInput!): [ProcessInstance]!

  """
  Signals process instances with specified ids or if specified also with containerId.
  """
  signalProcessInstances(input: SignalProcessInstancesInput!): [ProcessInstance]
}

"""
KIE API ProcessDefinition.
"""
type ProcessDefinition {
  # Id of the process definition
  id: String!
  # Name of the process definition
  name: String
  # Versions of the process definition
  version: String
  # Name of the package the process definition is located in
  packageName: String
  # Id of the container the process definition belongs to
  containerId: String
  # Entities associated with this process definition
  associatedEntities: Object
  # Service tasks this process definition contains
  serviceTasks: Object
  # Process variables defined in this process definition
  processVariables: Object
  # Reusable sub processes defined in this process definition
  reusableSubProcesses: [String]
  # Nodes defined in this process definition
  nodes: [NodeDefinition]
  # Timers defined in this process definition
  timers: [TimerDefinition]
  # Whether this definition is dynamic or not
  dynamic: Boolean
}

"""
KIE API TaskInputsDefinition.
"""
type TaskInputsDefinition {
  # Task inputs of this task inputs definition
  taskInputs: Object
}

"""
KIE API TaskOutputsDefinition.
"""
type TaskOutputsDefinition {
  # Task outputs of this task outputs definition
  taskOutputs: Object
}

"""
KIE API UserTaskDefinition.
"""
type UserTaskDefinition {
  # Id of this user task definition
  id: String!
  # Name of the user task definition
  name: String
  # Priority this user task definition has
  priority: Int
  # Creator of this user task definition
  createdBy: String
  # Whether this user task definition is skippable or not
  skippable: Boolean
  # Name of the form for this user task definition
  formName: String
  # Entities associated with this user task definition
  associatedEntities: [String]
  # Task input mappings for this user task definition
  taskInputMappings: TaskInputsDefinition
  # Task output mappings for this user task definition
  taskOutputMappings: TaskOutputsDefinition
}

"""
KIE API TimerDefinition.
"""
type TimerDefinition {
  # Id of the timer
  id: Long
  # Node name of the timer
  nodeName: String!
  # Unique identifier located in bpmn2 definition
  uniqueId: String
  # Id of the node in process definition
  nodeId: Long
}

"""
KIE API NodeDefinition.
"""
type NodeDefinition {
  # Id of the node
  id: Int
  # Name of the node
  name: String
  # Unique identifier located in bpmn2 definition
  uniqueId: String
  # Type of the node
  type: String
}

"""
KIE API TaskSummary.
"""
type TaskSummary {
  # Id of the task instance
  id: Long!
  # Name of the task
  name: String
  # Subject of the task
  subject: String
  # Description of the task
  description: String
  # Status that this task is currently in
  status: String
  # Priority of this task
  priority: Int
  # Whether this task can be skipped or not
  skipable: Boolean
  # Actual owner of this task instance
  actualOwner: String
  # Creator of this task instance
  createdBy: String
  # Date of tasks creation
  createdOn: Date
  # Date of when this task was activated
  activationTime: Date
  # Date of when this task expires
  expirationTime: Date
  # Id of the process instance this task belongs to
  processInstanceId: Long
  # Id of the process definition this task belongs to
  processId: String
  # Id of the container this tasks belongs to
  containerId: String
  # Id of the parent process instance
  parentId: Long
}

"""
KIE API TaskSummaryList.
"""
type TaskSummaryList {
  # List of task instance summaries
  tasks: [TaskSummary]
}

"""
KIE API TaskInstance
"""
type TaskInstance {
  # Id of the task instance
  id: Long!
  # Name of the task
  name: String
  # Subject of the task
  subject: String
  # Description of the task
  description: String
  # Status of the task instance
  status: String
  # Priority of the task instance
  priority: Int
  # Whether the task is skipable or not
  skipable: Boolean
  # Actual owner of the task instance
  actualOwner: String
  # User id of creator of task instance
  createdBy: String
  # Date when this instance was created
  createdOn: Date
  # Date when this instance was activated
  activationTime: Date
  # Date when this instance expires
  expirationDate: Date
  # Id of the work item of this task instance
  workItemId: Long
  # Id of the process instance this task belongs to
  processInstanceId: Long
  # Id of the parent process instance
  parentId: Long
  # Id of process definition this task belongs to
  processId: String
  # Id of the container that this task belongs to
  containerId: String
  # List of users that can own this task - potential owners
  potentialOwners: [String]
  # List of users that cant own this task
  excludedOwners: [String]
  # List of users that are business admins for this task
  businessAdmins: [String]
  # Input data of this task
  inputData: Object
  # Output data of this task
  outputData: Object
}

"""
KIE API ProcessInstance.
"""
type ProcessInstance {
  # Id of the process instance
  id: Long!
  # Id of the process definition
  processId: String
  # Name of the process
  processName: String
  # Version of the process instance
  processVersion: String
  # State this process instance is in
  state: Int
  # Id of the container that this process instance belongs to
  containerId: String!
  # Initiator of this process instance
  initiator: String!
  # Date of this process instance
  date: Date
  # Description of this process instance
  processInstanceDescription: String
  # Correlation key of this process instance
  correlationKey: String
  # Id of the parent process instance
  parentId: Long
  # SLA compliance
  slaCompliance: Int
  # Due date for SLA
  slaDueDate: Date
  # User tasks that are currently active
  activeUserTasks: TaskSummaryList
  # Variables of this process instance
  variables: Object
}

"""
Input object for ProcessInstances.
Allows users to select subset of its fields to
query process instances.
Process instances are matched based on the selected
fields. Not every combination is supported.
"""
input ProcessInstanceFilter {
  # List of states that process instances should be in
  statesIn: [Int]
  # Initiator of the process instance
  initiator: String
  # Id of container of the process instance
  containerId: String
  # Id of process definition of the process instance
  processId: String
  # Correlation key that process instance has
  correlationKey: String
  # Name of the process instance's process
  processName: String
  # Name of the variable that process instance has
  variableName: String
  # Value of the variable that process instance has
  variableValue: Object
}

"""
Input object for Tasks
Allows users to select subset of its fields to
query tasks. If more fields are selected an AND
operation will be enforced.
Tasks are matched based on the selected
fields. Not every combination is supported.
"""
input TaskInstanceFilter {
  # States that tasks should be in
  statesIn: [String]
  # Id of business admin that tasks should have
  businessAdminId: String
  # Id of potential owner
  potentialOwnerId: String
  # List of groupIds that tasks belongs to
  groupIds: [String]
  # Expirational date that task should have
  fromExpirationalDate: Date
  # Id of the process instance that tasks should belong to
  processInstanceId: Long
  # Name of the variable that task should have
  variableName: String
  # Value of the variable that task should have
  variableValue: Object
  # Id of the tasks owner
  ownerId: String
}

"""
Input for abortProcessInstances mutation.
"""
input AbortProcessInstancesInput {
  # List of IDs of the instances that you want to abort
  ids: [Long!]!
  # Id of a container that instances should belong to, optional argument,
  # in case there is Id that does not belong to it returned list is going to
  # contain null on its position
  containerId: String
}

"""
Input for startProcesses mutation.
"""
input StartProcessesInput {
  # Size of the started batch.
  batchSize: Int = 100
  # Identifier of the process
  id: String!
  # String identifier of the container of the process
  containerId: String!
  # A correlationKey that should be assigned to a started process instances
  # optional, must be unique
  correlationKey: String
  # Variables of the process
  variables: Object
}

"""
Input for signalProcessInstances mutation
"""
input SignalProcessInstancesInput {
  # List of IDs of the instances that you want to signal
  ids: [Long!]!
  # Name of the signal
  signalName: String!
  # An event object to be passed in
  event: Object!
  # String identified of the container of the process instances
  # optional, if not set it won't be used
  containerId: String
}
